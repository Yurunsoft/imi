# 热更新

[toc]

由于 imi 基于 Swoole 和 Workerman 常驻内存，PHP 热更新的传统方式并不适用。为了解决这个问题，imi 提供了热更新的解决方案，支持业务代码的动态加载和更新，方便开发调试和部署。同时，imi 保持了应用的稳定性和可靠性，支持平滑重启和进程管理。

有了热更新的支持，开发者可以在不停止服务的情况下，实时地更新代码并查看效果，大大提高了开发效率和调试体验。

> 请不要在生产环境使用热更新，可能会产生意料之外的问题

## 配置

imi 默认开启了热更新，如果需要关闭或者个性化设置请看下文：

热更新通过配置文件中的`beans`节配置。

详见下面的注释：

```php
'hotUpdate'    =>    [
    // 'status'    => false, // 关闭热更新去除注释，不设置即为开启，建议生产环境关闭

    // --- 文件修改时间监控 ---
    // 'monitorClass' => \Imi\HotUpdate\Monitor\FileMTime::class,
    // 'timespan'     => 1, // 检测时间间隔，单位：秒

    // --- Inotify 扩展监控 ---
    // 'monitorClass' => \Imi\HotUpdate\Monitor\Inotify::class,
    // 'timespan'     => 0, // 检测时间间隔，单位：秒，使用扩展建议设为0性能更佳

    // 'includePaths' => [], // 要包含的路径数组
    // 'excludePaths' => [], // 要排除的路径数组，支持通配符*
    // 'defaultPath'  => [], // 设为数组则覆盖默认的监控路径
    // 'process'      => false, // 允许热更新的进程，true：全部进程，false：不允许重启，array: 指定进程允许重启
],
```

> 认情况下，imi 采用文件修改时间来监控代码变化并实现热更新。但是建议在可行的情况下安装 `Inotify` 扩展以提高性能。

> 注意，如果你的项目所在目录的文件系统是共享目录或者映射目录，请不要使用 `Inotify` 模式。
